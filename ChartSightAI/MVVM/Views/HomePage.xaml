<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="ChartSightAI.MVVM.Views.HomePage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:Animations="clr-namespace:ChartSightAI.Animations"
    xmlns:Controls="clr-namespace:ChartSightAI.Controls"
    xmlns:VM="clr-namespace:ChartSightAI.MVVM.ViewModels"
    xmlns:bottomSheet="clr-namespace:Syncfusion.Maui.Toolkit.BottomSheet;assembly=Syncfusion.Maui.Toolkit"
    xmlns:mct="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
    x:DataType="VM:HomeVM"
    Background="{StaticResource Brush.BackgroundGradient}"
    Shell.NavBarIsVisible="False">

    <!--  Root AbsoluteLayout: Main Content Area, Fixed TabBar  -->
    <AbsoluteLayout>

        <!--  Main Content Area (Header + ScrollView) - Takes up space except for the bottom tab bar  -->
        <Grid
            AbsoluteLayout.LayoutBounds="0,0,1,1"
            AbsoluteLayout.LayoutFlags="All"
            RowDefinitions="Auto,*">
            <!--  Two rows: Header (Auto), Scrollable Content (Star)  -->

            <!--  Row 0: Fixed Header  -->
            <HorizontalStackLayout Grid.Row="0" Padding="20,20,20,20">
                <Border
                    x:Name="HeaderLayout"
                    Margin="-70,0,0,0"
                    Background="{StaticResource Brush.HeaderGradient}"
                    StrokeShape="RoundRectangle 30"
                    StrokeThickness="0"
                    WidthRequest="300">
                    <HorizontalStackLayout Margin="0,0,5,0" HorizontalOptions="End">
                        <Image
                            Aspect="AspectFit"
                            HeightRequest="50"
                            Source="logo.png"
                            VerticalOptions="Center"
                            WidthRequest="50" />
                        <Label
                            Margin="0,0,0,0"
                            StyleClass="h2"
                            Text="ChartSightAI"
                            VerticalOptions="Center" />
                    </HorizontalStackLayout>
                </Border>

                <HorizontalStackLayout
                    x:Name="Settings"
                    Margin="60,0,0,0"
                    HorizontalOptions="End"
                    Spacing="10">
                    <Border
                        Background="{StaticResource Brush.ButtonGradient}"
                        HeightRequest="40"
                        Shadow="{StaticResource Sh.CardShadow}"
                        StrokeShape="RoundRectangle 999"
                        StrokeThickness="0"
                        WidthRequest="40">
                        <Image
                            HeightRequest="20"
                            Source="history.png"
                            WidthRequest="20">
                            <Image.GestureRecognizers>
                                <TapGestureRecognizer Command="{Binding GoToHistoryCommand}" />
                            </Image.GestureRecognizers>
                        </Image>
                    </Border>
                    <Border
                        Background="{StaticResource Brush.ButtonGradient}"
                        HeightRequest="40"
                        Shadow="{StaticResource Sh.CardShadow}"
                        StrokeShape="RoundRectangle 999"
                        StrokeThickness="0"
                        WidthRequest="40">
                        <Image
                            HeightRequest="20"
                            Source="settings.png"
                            WidthRequest="20">
                            <Image.GestureRecognizers>
                                <TapGestureRecognizer Command="{Binding GoToSettingsCommand}" />
                            </Image.GestureRecognizers>
                        </Image>
                    </Border>

                </HorizontalStackLayout>
            </HorizontalStackLayout>

            <!--  Row 1: Scrollable Main Content  -->
            <ScrollView Grid.Row="1" VerticalScrollBarVisibility="Never">
                <VerticalStackLayout
                    x:Name="Body"
                    Padding="20,0,20,0"
                    Spacing="15">
                    <!--  Add left/right padding here  -->

                    <!--  Main Card  -->
                    <Border StyleClass="CardStyle">
                        <VerticalStackLayout Spacing="15">
                            <Label StyleClass="h1" Text="Start a new                                    chart analysis" />
                            <Label StyleClass="caption" Text="Choose your market and upload a chart to begin" />

                            <Button
                                Background="{StaticResource Brush.ButtonGradient}"
                                Clicked="Button_Clicked"
                                Shadow="{StaticResource Sh.CardShadow}"
                                StyleClass="ButtonStyle"
                                Text="+ New Analysis">
                                <Button.Behaviors>
                                    <mct:AnimationBehavior EventName="Clicked">
                                        <mct:AnimationBehavior.AnimationType>
                                            <Animations:SampleScaleAnimation Easing="{x:Static Easing.Linear}" Length="100" />
                                        </mct:AnimationBehavior.AnimationType>
                                    </mct:AnimationBehavior>
                                </Button.Behaviors>
                            </Button>

                            <Label
                                HorizontalOptions="Center"
                                StyleClass="caption"
                                Text="Supports Forex, Stocks, and Crypto charts" />

                            <!--  Placeholder for Animation Shape  -->
                            <Border
                                Margin="0,20,0,0"
                                BackgroundColor="Transparent"
                                HeightRequest="150"
                                HorizontalOptions="Center"
                                StrokeShape="RoundRectangle 30"
                                StrokeThickness="0"
                                VerticalOptions="Center">
                                <Image
                                    Aspect="AspectFit"
                                    IsAnimationPlaying="True"
                                    Source="growth.gif" />
                            </Border>

                        </VerticalStackLayout>
                    </Border>

                    <!--  Tip Box  -->
                    <Border StyleClass="CardStyle">
                        <Grid ColumnDefinitions="Auto,*">
                            <Image
                                Grid.Column="0"
                                Margin="0,0,10,0"
                                Aspect="AspectFit"
                                HeightRequest="40"
                                IsAnimationPlaying="True"
                                Source="idea.gif"
                                VerticalOptions="Center"
                                WidthRequest="40" />
                            <Label
                                Grid.Column="1"
                                LineBreakMode="WordWrap"
                                MaxLines="2"
                                StyleClass="body"
                                Text="Tip: For accurate results, make sure your chart shows price candles clearly." />
                        </Grid>
                    </Border>

                </VerticalStackLayout>
            </ScrollView>
        </Grid>

        <!--  Fixed TabBar (Occupies bottom of screen)  -->
        <Controls:TABBAR
            Margin="0,0,0,20"
            AbsoluteLayout.LayoutBounds="0.5,1,1,76"
            AbsoluteLayout.LayoutFlags="PositionProportional,WidthProportional"
            ZIndex="1000" />

    </AbsoluteLayout>

</ContentPage>